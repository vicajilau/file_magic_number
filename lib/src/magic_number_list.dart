import '../file_magic_number.dart';

class MagicNumberList {
  /// A map of known magic number signatures associated with number of bytes
  static const Map<List<int>, FileMagicNumberType> magicNumbers = {
    // Complex file types (can contain other files)

    // 8 bytes
    // 7 bytes
    [0x52, 0x61, 0x72, 0x21, 0x1A, 0x07, 0x00]: FileMagicNumberType.rar,

    // 6 bytes
    [0x52, 0x61, 0x72, 0x21, 0x1A, 0x07]: FileMagicNumberType.rar,
    [0x37, 0x7A, 0xBC, 0xAF, 0x27, 0x1C]: FileMagicNumberType.sevenZ,

    // 5 bytes
    [0x75, 0x73, 0x74, 0x61, 0x72]: FileMagicNumberType.tar,

    // 4 bytes
    [0x25, 0x50, 0x44, 0x46]: FileMagicNumberType.pdf,
    [0x50, 0x4B, 0x03, 0x04]: FileMagicNumberType.zip,

    // Simple file types
    // 12 bytes
    [0x52, 0x49, 0x46, 0x46, 0x00, 0x00, 0x00, 0x00, 0x57, 0x45, 0x42, 0x50]: FileMagicNumberType.webp, // RIFF...WEBP
    // 8 bytes
    [0x66, 0x74, 0x79, 0x70, 0x68, 0x65, 0x69, 0x63]: FileMagicNumberType.heic,
    [0x66, 0x74, 0x79, 0x70, 0x6D, 0x69, 0x66, 0x31]: FileMagicNumberType.heic,
    [0x66, 0x74, 0x79, 0x70, 0x68, 0x65, 0x69, 0x78]: FileMagicNumberType.heic,
    [0x66, 0x74, 0x79, 0x70, 0x6D, 0x70, 0x34, 0x31]: FileMagicNumberType.mp4,
    [0x66, 0x74, 0x79, 0x70, 0x6D, 0x70, 0x34, 0x32]: FileMagicNumberType.mp4,
    [0x66, 0x74, 0x79, 0x70, 0x69, 0x73, 0x6F, 0x6D]: FileMagicNumberType.mp4,
    [0x66, 0x74, 0x79, 0x70, 0x4D, 0x53, 0x4E, 0x56]: FileMagicNumberType.mp4,
    [0x66, 0x74, 0x79, 0x70, 0x61, 0x76, 0x63, 0x31]: FileMagicNumberType.mp4,
    [0x66, 0x74, 0x79, 0x70, 0x33, 0x67, 0x70, 0x34]: FileMagicNumberType.mp4,
    [0x66, 0x74, 0x79, 0x70, 0x4D, 0x34, 0x56, 0x20]: FileMagicNumberType.mp4,

    // 7 bytes
    // No simple types with this length in the list

    // 6 bytes
    [0x53, 0x51, 0x4C, 0x69, 0x74, 0x65]: FileMagicNumberType.sqlite,

    // 5 bytes
    // No simple types with this length in the list

    // 4 bytes
    // Simple file types
    [0x89, 0x50, 0x4E, 0x47]: FileMagicNumberType.png,
    [0x47, 0x49, 0x46, 0x38]: FileMagicNumberType.gif,
    [0x49, 0x49, 0x2A, 0x00]: FileMagicNumberType.tiff,
    [0x4D, 0x4D, 0x00, 0x2A]: FileMagicNumberType.tiff,
    [0x66, 0x74, 0x79, 0x70]: FileMagicNumberType.heic,
    [0x7F, 0x45, 0x4C, 0x46]: FileMagicNumberType.elf,
    [0x52, 0x49, 0x46, 0x46]: FileMagicNumberType.wav, // RIFF header, check for WAVE at offset 8
    [0xFF, 0xD8, 0xFF, 0xE0]: FileMagicNumberType.jpg, // JPEG (JFIF)
    [0xFF, 0xD8, 0xFF, 0xE1]: FileMagicNumberType.jpg, // JPEG (EXIF)

    // 3 bytes
    // Simple file types
    [0x49, 0x44, 0x33]: FileMagicNumberType.mp3,
    [0xFF, 0xD8, 0xFF]: FileMagicNumberType.jpg, // JPEG (generic)

    // 2 bytes
    // Simple file types
    [0x4D, 0x5A]: FileMagicNumberType.exe,
    [0x42, 0x4D]: FileMagicNumberType.bmp,
  };
}
